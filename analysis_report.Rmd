---
title: "lvws_sensitivity_analysis"
date: "`r Sys.Date()`"
output:
  html_document: default
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

``` {r, include = FALSE}

source("scripts/04_analysis_intermediate.R")

```

# Loch Vale Water Chemistry Sensitivity Analysis

**What trends exist within the data? Do these trends changed based on sampling frequency?**  
Examining all post-1995 data for all major ions and parameters using both a linear and general additive model.    

Are major ions increasing in concentration in a linear manner over time? 

Are there certain months in which said increase is linear? 

# Testing for linear trends by month 
## Nitrate
```{r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot2::ggplot(data = loch_o_chem, aes(x = DATE, y = NO3_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Nitrate") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = NO3_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Nitrate") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = NO3_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Nitrate") +
  theme_pubclean()

```

### Table of results - nitrate
``` {r, echo = FALSE}
no3_table <- no3_calc_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%   mutate(frequency = factor(frequency,                             levels=c("weekly",                                      "bi-monthly",                                      "monthly"))) %>%
  mutate(frequency = factor(frequency,
                            levels=c("weekly",
                                     "bi-monthly",
                                     "monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  # set_background_color(evens,everywhere, "grey95") %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**") 
no3_table
```

## Calcium
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot2::ggplot(data = loch_o_chem, aes(x = DATE, y = CA)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) + 
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Calcium") +
  theme_pubclean()

```

Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = CA)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Calcium") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = CA)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Calcium") +
  theme_pubclean()

```

### Table of results - calcium
``` {r, echo = FALSE}
ca_table <- ca_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%   mutate(frequency = factor(frequency,                             levels=c("weekly",                                      "bi-monthly",                                      "monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
ca_table

```


## Silica
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = SiO2)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Silica") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = SiO2)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Silica") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = SiO2)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Silica") +
  theme_pubclean()

```

### Table of results - silica
``` {r, echo = FALSE}
sio2_table <- sio2_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%   mutate(frequency = factor(frequency,                             levels=c("weekly",                                      "bi-monthly",                                      "monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
sio2_table

```

## Temperature
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = TEMP)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Temperature") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = TEMP)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Temperature") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = TEMP)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Temperature") +
  theme_pubclean()

```

### Table of results - Temperature
``` {r, echo = FALSE}
temp_table <- temp_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%   mutate(frequency = factor(frequency,                             levels=c("weekly",                                      "bi-monthly",                                      "monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
temp_table

```


## ANC
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = ANC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "ANC") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = ANC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "ANC") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = ANC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "ANC") +
  theme_pubclean()

```


## Conductivity (lab)
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = LABCOND)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Conductivity (lab)") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = LABCOND)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Conductivity (lab)") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = LABCOND)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Conductivity (lab)") +
  theme_pubclean()

```




## pH (lab)
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = LABPH)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "pH (lab)") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = LABPH)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "pH (lab)") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = LABPH)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "pH (lab)") +
  theme_pubclean()

```


## Magnesium
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = MG)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Magnesium") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = MG)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Magnesium") +
  theme_pubclean()
  
```

Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = MG)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Magnesium") +
  theme_pubclean()

```

### Table of results - magnesium
``` {r, echo = FALSE}
mg_table <- mg_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%   mutate(frequency = factor(frequency,                             levels=c("weekly",                                      "bi-monthly",                                      "monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
mg_table

```


## Sulfate
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = SO4)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Sulfate") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = SO4)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Sulfate") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = SO4)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Sulfate") +
  theme_pubclean()

```

### Table of results - sulfate
``` {r, echo = FALSE}
so4_table <- so4_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%   mutate(frequency = factor(frequency,                             levels=c("weekly",                                      "bi-monthly",                                      "monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
so4_table

```


## Chlorine
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = CL)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Chlorine") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = CL)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Chlorine") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = CL)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Chlorine") +
  theme_pubclean()

```

### Table of results - chlorine
``` {r, echo = FALSE}
cl_table <- cl_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%   mutate(frequency = factor(frequency,                             levels=c("weekly",                                      "bi-monthly",                                      "monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
cl_table

```


## DOC
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = DOC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "DOC") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = DOC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "DOC") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = DOC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "DOC") +
  theme_pubclean()

```

### Table of results - DOC
``` {r, echo = FALSE}
doc_table <- doc_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%   mutate(frequency = factor(frequency,                             levels=c("weekly",                                      "bi-monthly",                                      "monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
doc_table

```


## TDN
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = TDN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "TDN") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = TDN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "TDN") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = TDN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "TDN") +
  theme_pubclean()

```


## Ammonium
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = NH4_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Ammonium") +
  theme_pubclean()

```

Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = NH4_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Ammonium") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = NH4_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Ammonium") +
  theme_pubclean()

```

### Table of results - ammonium
``` {r, echo = FALSE}
nh4_table <- nh4_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%   mutate(frequency = factor(frequency,                             levels=c("weekly",                                      "bi-monthly",                                      "monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
nh4_table

```


## TIN
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = TIN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "TIN") +
  theme_pubclean()

``` 


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = TIN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "TIN") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = TIN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "TIN") +
  theme_pubclean()

```


## DON
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = DON)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "DON") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = DON)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "DON") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = DON)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "DON") +
  theme_pubclean()

```






