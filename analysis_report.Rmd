---
title: "Loch Outlet Water Chemistry Sensitivity Analysis"
author: "By Adeline Kelly w input from Bella Oleksy"
date: "Last compiled `r Sys.Date()`"
output: 
  html_document:
    theme: flatly
    toc: yes
    toc_float:
      collapsed: true
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

``` {r, include = FALSE}

source("scripts/04_analysis_intermediate.R")

```


**What trends exist within the data? Do these trends changed based on sampling frequency?**  

Examining all post-1995 data for all major ions and parameters using both a linear and general additive model.    

Are major ions increasing in concentration in a linear manner over time? 

Are there certain months in which said increase is linear? 

# Testing for linear trends by month 
## Nitrate
```{r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot2::ggplot(data = loch_o_chem, aes(x = DATE, y = NO3_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Nitrate") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = NO3_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Nitrate") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = NO3_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Nitrate") +
  theme_pubclean()

```

### Table of results - nitrate
``` {r, echo = FALSE}
no3_table <- no3_calc_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%
  mutate(frequency = factor(frequency,
                            levels=c("weekly",
                                     "bi-monthly",
                                     "monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  # set_background_color(evens,everywhere, "grey95") %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**") 
no3_table
```

### Density distributions - nitrate

If the density plots overlap, that indicates that we are not losing any extreme values / natural variability with bi-monthly or monthly samples.

``` {r, fig.width=12, fig.height=9, echo = FALSE}

#Bind all the samples together into new dataframe
NO3_all <- bind_rows(loch_o_chem %>%
  select(NO3, MONTH, YEAR) %>%
  mutate(frequency = "weekly"),  
loch_o_chem %>%
  group_by(MONTH, YEAR) %>%
  sample_n(size = 2, replace = FALSE) %>%
  select(NO3) %>%
  mutate(frequency = "bi-monthly"),
loch_o_chem %>%
  group_by(MONTH, YEAR) %>%
  sample_n(size = 1, replace = FALSE) %>%
  select(NO3) %>%
  mutate(frequency = "monthly")) %>%
  #Arrange the frequency levels from most to least frequent
  mutate(frequency = factor(frequency,
                            levels=c("weekly",
                                     "bi-monthly",
                                     "monthly"))) 

#Plot all samples regardless of month
ggplot(NO3_all, aes(NO3, color=frequency, fill=frequency))+
    geom_density(alpha=0.2)+
  labs(x="Nitrate",
       title="All samples")

#Plot by month
ggplot(NO3_all, aes(NO3, color=frequency, fill=frequency))+
    geom_density(alpha=0.2)+
  facet_wrap(~MONTH, scales="free_y")+
  labs(x="Nitrate",
       title="All samples")
```

### Ridgelines - nitrate
This plot now include all data (unfiltered) for the full LVWS record.

``` {r, fig.width=12, fig.height=9, echo = FALSE}
## I pulled in the full time series here to make these pretty ridgeline plots
## that Jill was excited about
ggplot(water_chem %>%
         filter(SITE=="LOCH.O" & TYPE=="NORMAL"), aes(x = NO3_calc, y = YEAR, group=YEAR)) +
  geom_density_ridges(
    scale = 7,
    size = 0.25,
    rel_min_height = 0.01, #You can comment this out to keep the long tails
    fill = "#c26f8b",
    alpha = 0.4)+
  scale_y_reverse(breaks = c(seq(2022, 1982, -4)))+
  theme_minimal()+
  labs(x="Nitrate",
       y="Year",
       title="Year-round samples")

ggplot(water_chem %>%
         filter(SITE=="LOCH.O" &
                  TYPE=="NORMAL" &
                  MONTH %in% c(7,8)), aes(x = NO3_calc, y = YEAR, group=YEAR)) +
  geom_density_ridges(
    scale = 7,
    size = 0.25,
    rel_min_height = 0.01, #You can comment this out to keep the long tails
    fill = "#b2df8a",
    alpha = 0.4)+
  scale_y_reverse(breaks = c(seq(2022, 1982, -4)))+
  theme_minimal()+
  labs(x="Nitrate",
       y="Year",
       title="Summer only (July-August)")
```

### Intra-annual trends - nitrate

``` {r, fig.width=10, fig.height=9, echo = FALSE}
## Here I'm taking all the unfiltered data than getting an average for every MONTH*YEAR combination. Tried to find a diverging colorblind friendly color scheme to make it easier to view the extreme years. 

##And then I got fancy and messed around with gganimate. Comment out that part if you're having a hard time knitting the file or rendering the plots
devtools::install_github('thomasp85/gganimate')

gg_intra_annual_NO3 <- water_chem %>%
         filter(SITE=="LOCH.O" & TYPE=="NORMAL") %>%
  group_by(YEAR, MONTH) %>%
  summarize(NO3_calc = mean(NO3_calc, na.rm=TRUE)) %>%
  ggplot(aes(x = MONTH, y = NO3_calc, group=YEAR)) +
  geom_line(aes(color=YEAR))+
  geom_point(shape=21, aes(fill=YEAR))+
  scale_fill_gradientn(colours = viridis(256, option = "B"))+
  scale_color_gradientn(colours = viridis(256, option = "B"))+
  scale_x_continuous(limits = c(1,12), breaks=c(1:12))+
  theme_few()+
  theme(panel.background = element_rect(fill="grey95"))

# Here comes the gganimate specific bits
gg_intra_annual_NO3 +
  transition_time(YEAR) +
  labs(title = 'Year: {frame_time}', x = 'Month', y = 'NO3 (mg/L)') +
  shadow_mark()
```


## Calcium
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot2::ggplot(data = loch_o_chem, aes(x = DATE, y = CA)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) + 
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Calcium") +
  theme_pubclean()

ggplot2::ggplot(data = loch_o_chem %>%
                  group_by(YEAR, MONTH) %>%
                  summarize(CA = mean(CA, na.rm=TRUE)), aes(x = YEAR, y = CA)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) + 
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Calcium") +
  theme_pubclean()

```

Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = CA)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Calcium") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = CA)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Calcium") +
  theme_pubclean()

```

### Table of results - calcium
``` {r, echo = FALSE}
ca_table <- ca_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%
  mutate(frequency = factor(frequency,
                            levels=c("weekly","bi-monthly","monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
ca_table

```


## Silica
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = SiO2)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Silica") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = SiO2)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Silica") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = SiO2)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Silica") +
  theme_pubclean()

```

### Table of results - silica
``` {r, echo = FALSE}
sio2_table <- sio2_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>% 
    mutate(frequency = factor(frequency,
                            levels=c("weekly","bi-monthly","monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
sio2_table

```

## Temperature

Something to discuss at some point-- how do we want to deal with temperature values less than zero?
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = TEMP)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Temperature") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = TEMP)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Temperature") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = TEMP)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Temperature") +
  theme_pubclean()

```

### Table of results - Temperature
``` {r, echo = FALSE}
temp_table <- temp_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>% 
  mutate(frequency = factor(frequency,
                            levels=c("weekly","bi-monthly","monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
temp_table

```


## ANC
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = ANC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "ANC") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = ANC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "ANC") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = ANC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "ANC") +
  theme_pubclean()

```


## Conductivity (lab)
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = LABCOND)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Conductivity (lab)") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = LABCOND)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Conductivity (lab)") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = LABCOND)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Conductivity (lab)") +
  theme_pubclean()

```




## pH (lab)
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = LABPH)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "pH (lab)") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = LABPH)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "pH (lab)") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = LABPH)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "pH (lab)") +
  theme_pubclean()

```


## Magnesium
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = MG)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Magnesium") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = MG)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Magnesium") +
  theme_pubclean()
  
```

Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = MG)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Magnesium") +
  theme_pubclean()

```

### Table of results - magnesium
``` {r, echo = FALSE}
mg_table <- mg_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%
  mutate(frequency = factor(frequency,
                            levels=c("weekly","bi-monthly","monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
mg_table

```


## Sulfate
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = SO4)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Sulfate") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = SO4)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Sulfate") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = SO4)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Sulfate") +
  theme_pubclean()

```

### Table of results - sulfate
``` {r, echo = FALSE}
so4_table <- so4_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%
  mutate(frequency = factor(frequency,
                            levels=c("weekly","bi-monthly","monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
so4_table

```


## Chlorine
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = CL)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Chlorine") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = CL)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Chlorine") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = CL)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Chlorine") +
  theme_pubclean()

```

### Table of results - chlorine
``` {r, echo = FALSE}
cl_table <- cl_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%
    mutate(frequency = factor(frequency,
                            levels=c("weekly","bi-monthly","monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
cl_table

```


## DOC
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = DOC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "DOC") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = DOC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "DOC") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = DOC)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "DOC") +
  theme_pubclean()

```

### Table of results - DOC
``` {r, echo = FALSE}
doc_table <- doc_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>% 
    mutate(frequency = factor(frequency,
                            levels=c("weekly","bi-monthly","monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
doc_table

```


## TDN
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = TDN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "TDN") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = TDN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "TDN") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = TDN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "TDN") +
  theme_pubclean()

```


## Ammonium
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = NH4_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "Ammonium") +
  theme_pubclean()

```

Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = NH4_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Ammonium") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = NH4_calc)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "Ammonium") +
  theme_pubclean()

```

### Table of results - ammonium
``` {r, echo = FALSE}
nh4_table <- nh4_linear %>%
  select(MONTH, frequency, estimate, p.value, Significance) %>%
    mutate(frequency = factor(frequency,
                            levels=c("weekly","bi-monthly","monthly"))) %>%
  arrange(MONTH, frequency) %>%
  as_hux() %>%
  set_background_color(evens,everywhere, "grey80") %>% set_background_color(odds,everywhere, "grey90") %>%
  set_all_borders(brdr(0.4,"solid", "white")) %>%
  set_outer_padding(4) %>%
  set_markdown_contents(1, 1, "**Month**") %>%
  set_markdown_contents(1, 2, "**Sampling Frequency**") %>%
  set_markdown_contents(1, 3, "**Slope**") %>%
  set_markdown_contents(1, 4, "**p-value**") %>%
  set_markdown_contents(1, 5, "**Significance**")
nh4_table

```


## TIN
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = TIN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "TIN") +
  theme_pubclean()

``` 


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = TIN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "TIN") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = TIN)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "TIN") +
  theme_pubclean()

```


## DON
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)

ggplot(data = loch_o_chem, aes(x = DATE, y = DON)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") +
  labs(x = "Year", y = "DON") +
  theme_pubclean()

```


Biweekly sampling frequency
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)

ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 2, replace = FALSE), 
       aes(x = DATE, y = DON)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "DON") +
  theme_pubclean()
  
```


Sampling once a month
``` {r, fig.width=12, fig.height=9, echo = FALSE}

library(ggplot2)
library(ggpubr)
ggplot(data = loch_o_chem %>%
                    group_by(MONTH, YEAR) %>%
                    sample_n(size = 1, replace = FALSE), 
       aes(x = DATE, y = DON)) +
  geom_point() + 
  geom_line() + 
  facet_wrap(~ MONTH, scales = "free", labeller = as_labeller(month_labels)) +
  geom_smooth(method = "lm", colour = "deeppink") +
  #geom_smooth(method = "gam", colour = "purple") +
          stat_cor(aes(label = paste(after_stat(rr.label), ..p.label.., sep = "~`,`~")),
                       p.accuracy = 0.001, r.accuracy = 0.01, label.x.npc = 0.4, color = "deeppink") + 
  labs(x = "Year", y = "DON") +
  theme_pubclean()

```






